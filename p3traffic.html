<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Smartz Traffic Management System</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: url('https://thumbs.dreamstime.com/b/futuristic-highway-traffic-management-system-integrating-data-smart-city-seamlessly-optimizing-flow-enhancing-efficiency-342659512.jpg') no-repeat center center fixed;
      background-size: cover;
      margin: 0;
      color: #222;
    }
    .container {
      background: rgba(255,255,255,0.92);
      max-width: 600px;
      margin: 38px auto;
      padding: 30px 32px 30px 32px;
      border-radius: 16px;
      box-shadow: 0 4px 28px rgba(0,0,0,0.16);
      position: relative;
    }
    .logo-row {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      font-size: 1.18em;
      font-weight: 600;
      color: #045195;
      gap: 6px;
      margin-bottom: 14px;
      letter-spacing: 1px;
    }
    .infinity {
      font-family: Arial, sans-serif;
      font-size: 1.24em;
      margin-left: 4px;
      vertical-align: 0.1em;
    }
    .signal-input-box {
      background: linear-gradient(135deg,#dbeaff 82%,#514d4d 18%);
      border: 4px solid #656565;
      border-radius: 32px;
      padding: 17px 16px 22px 16px;
      max-width: 480px;
      margin: 0 auto 20px auto;
      box-shadow: 0 2px 10px rgba(0,0,0,0.10);
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .signal-input-box label {
      font-size: 1em;
      margin-top: 9px;
    }
    select, input[type="text"] {
      width: 60%;
      min-width: 100px;
      padding: 4px 6px;
      border: 1px solid #aaa;
      border-radius: 5px;
      background: #f7f8fa;
      font-size: 1em;
      margin-bottom: 2px;
      display: inline-block;
      box-sizing: border-box;
    }
    .input-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 2px;
    }
    .apply-btn {
      margin: 16px auto 0 auto;
      display: block;
      font-size: 1em;
      font-weight: 700;
      padding: 10px 38px;
      background: #05b505;
      color: #fff;
      border: none;
      border-radius: 9px;
      cursor: pointer;
      box-shadow: 0 1px 7px rgba(44,162,71,0.13);
      transition: background 0.19s;
    }
    .apply-btn:hover { background: #028a02;}
    .or-divider {
      text-align: center;
      margin: 8px 0;
      font-weight: bold;
      color: #726e7f;
    }
    .nav-btn {
      position: absolute;
      top: 58%;
      transform: translateY(-50%);
      z-index: 10;
      background: #022b45;
      color: #fff;
      border: none;
      border-radius: 50%;
      font-size: 1.6em;
      padding: 13px 17px;
      cursor: pointer;
      transition: background 0.2s, box-shadow 0.18s;
      box-shadow: 0 2px 12px rgba(2,43,69,0.11);
      display: flex;
      align-items: center;
      justify-content: center;
      outline: none;
    }
    .nav-btn.left {left: -62px;}
    .nav-btn.right {right: -62px;}
    .nav-btn:active {background: #0b355b;}
    .signal-status-area {
      margin-top: 12px;
      margin-bottom: 22px;
      background: rgba(217,234,255,0.92);
      border: 3px solid #787d82;
      border-radius: 32px;
      box-shadow: 0 3px 14px rgba(0,86,168,0.09);
      padding: 36px 40px 34px 20px;
      max-width: 590px;
      margin-left: auto;
      margin-right: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      min-height: 300px;
      transition: opacity 0.4s;
    }
    .signal-status-title {
      text-align:center;
      font-size:1.19em;
      font-weight:700;
      color:#001845;
      margin-bottom:20px;
      transition: opacity 0.4s;
    }
    .hide {
      opacity: 0 !important;
      transition: opacity 0.4s;
      pointer-events: none;
      user-select: none;
    }
    .timer-change-btn {
      position: absolute;
      right: 13px;
      top: 22px;
      background: #ffcb04;
      color: #033;
      padding: 6px 14px 6px 12px;
      font-weight: 700;
      border-radius: 8px;
      border: none;
      font-size: 1.01em;
      box-shadow: 0 2px 6px rgba(0,0,0,0.13);
      cursor: pointer;
      transition: background 0.13s;
      display: flex;
      align-items: center;
      gap: 6px;
      z-index: 2;
    }
    .timer-icon {
      font-size: 1.2em;
    }
    .timer-change-btn:hover {
      background: #ffd342;
    }
    .traffic-light-box {
      display: flex;
      flex-wrap: wrap;
      gap: 36px 18px;
      justify-content: center;
      align-items: flex-end;
    }
    .traffic-device {
      background: #1b1e22;
      border-radius: 20px;
      width: 72px;
      padding: 14px 4px 8px 4px;
      display: flex;
      flex-direction: column;
      align-items: center;
      box-shadow: 0 4px 18px rgba(10,10,10,0.16);
      border: 3px solid #212325;
      position: relative;
      margin-bottom: 8px;
      min-height: 210px;
      transition: opacity 0.4s;
    }
    .bulb {
      width: 42px; height: 42px;
      border-radius: 50%;
      margin: 10px auto 0 auto;
      margin-bottom: 5px;
      box-shadow: 0 1px 11px 2px rgba(0,0,0,0.10);
      border: 3px solid #49494a;
      background: #222;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1em;
      transition: background 0.36s, box-shadow 0.22s;
    }
    .bulb.red.on    { background: radial-gradient(circle at 60% 40%, #ff6c71 65%, #9a0226 97%); box-shadow: 0 0 42px 10px #ff3548; }
    .bulb.red       { background: #551618; }
    .bulb.yellow.on { background: radial-gradient(circle at 60% 40%, #ffed65 61%, #bda90c 94%); box-shadow: 0 0 30px 6px #ffe554; }
    .bulb.yellow    { background: #737318; }
    .bulb.green.on  { background: radial-gradient(circle at 60% 40%, #44e178 82%, #0b704f 92%); box-shadow: 0 0 33px 7px #40fcbe; }
    .bulb.green     { background: #117c3e; }
    .bulb.blank     { background: #444!important; }
    .timer-box {
      margin-top: 7px;
      font-family: Consolas, monospace;
      font-size: 1.09em;
      font-weight: 700;
      color: #222;
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 2px 8px;
      border-radius: 7px;
      background: #f5f7ff;
      min-width: 60px;
      justify-content: center;
    }
    .timer-red { color: #e74c3c; background: #ffeaea;}
    .timer-yellow { color: #ad991d; background: #f5fcd4;}
    .timer-green { color: #008252; background: #d1ffec;}
    .timer-blank { color: #787878; background: #ededed;}
    .clock-icon {
      font-size: 1.08em;
      margin-right: 2px;
      color: inherit;
      vertical-align: middle;
    }
    .device-label {
      color: #fff;
      font-weight: 650;
      margin-bottom: 7px;
      text-align: center;
      font-size: 0.98em;
      line-height: 1.2;
      transition: color 0.2s;
    }
    .device-label span {
      font-size:0.93em; color:#ffd980;
    }
    .blank-label {
      color: #444!important;
    }
    .actions-box {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 30px;
      gap: 22px;
    }
    .get-btn {
      background: #045195;
      color: #fff;
      border: none;
      border-radius: 9px;
      padding: 15px 38px;
      font-size: 1.03em;
      font-weight: 650;
      cursor: pointer;
      box-shadow: 0 1px 7px rgba(25,52,98,0.13);
      transition: background 0.19s;
    }
    .get-btn:hover { background: #116894;}
    .emergency-btn {
      background: #e00000;
      color: #fafafa;
      border: none;
      border-radius: 14px;
      padding: 19px 55px 19px 55px;
      font-size: 1.18em;
      font-weight: 850;
      cursor: pointer;
      box-shadow:0 2px 23px rgba(235,53,50,0.31);
      letter-spacing: 1.2px;
      display: flex;
      align-items: center;
      gap: 13px;
      transition: background 0.14s, box-shadow 0.22s;
      margin-left: 12px;
      outline: none;
      position: relative;
    }
    .emergency-btn:hover { background: #b50202; box-shadow:0 2px 42px rgba(235,53,50,0.44);}
    .emergency-symbol {
      font-size: 2.1em;
      color: #fff;
      vertical-align: middle;
      text-shadow: 0 3px 10px rgba(0,0,0,0.17);
    }
    @media (max-width: 760px) {
      .container, .signal-status-area { max-width: 99vw !important; }
      select, input[type="text"] { width: 90%;}
      .nav-btn.left {left: -10px;}
      .nav-btn.right {right: -10px;}
      .signal-status-area {padding-right: 18px;}
    }
  </style>
</head>
<body>
<div class="container">
  <div class="logo-row">
    limits <span class="infinity">&#8734;</span>
  </div>
  <form class="signal-input-box" id="configForm">
    <div class="input-row">
      <label for="district">Choose District</label>
      <select id="district" name="district" required>
        <option value="">Select</option>
        <option>bhubaneswar</option>
        <option>Cuttack</option>
        <option>puri</option>
        <option>anugul</option>
        <option>sundargarh</option>
        <option>sambalpur</option>
        <option>kendra para</option>
        <option>berhampur</option>
        <option>balasore</option>
        <option>deogarh</option>
      </select>
    </div>
    <div class="input-row">
      <label for="area">Choose Area</label>
      <select id="area" name="area" required>
        <option value="">Select</option>
        <option>area 22A</option>
        <option>area 23A</option>
        <option>area25</option>
        <option>area 26</option>
        <option>area27A</option>
        <option>area55</option>
        <option>area 30A</option>
      </select>
    </div>
    <div class="input-row">
      <label for="route">Route No.</label>
      <select id="route" name="route" required>
        <option value="">Select</option>
        <option>1</option>
        <option>2</option>
        <option>3</option>
        <option>4</option>
        <option>5</option>
        <option>6</option>
      </select>
    </div>
    <div class="input-row">
      <label for="square">Choose Square</label>
      <select id="square" name="square" required>
        <option value="">Select</option>
        <option>retang square</option>
        <option>gohria square</option>
        <option>Dn square</option>
        <option>Kiits square</option>
        <option>kalinga square</option>
        <option>baramunda</option>
        <option>master canteensq.</option>
      </select>
    </div>
    <div class="or-divider">— OR —</div>
    <div class="input-row">
      <label for="signalNo">Signal No.</label>
      <input type="text" id="signalNo" name="signalNo" placeholder="e.g. S1128">
    </div>
    <button class="apply-btn" type="submit">Apply</button>
  </form>
  <button class="nav-btn left" title="Previous Page">&#8592;</button>
  <div class="signal-status-area" id="signalStatusArea">
    <button class="timer-change-btn" id="changeTimerBtn" title="Change Timer" style="display:none;">
      <span class="timer-icon">&#9200;</span> Change Timer
    </button>
    <div class="signal-status-title" id="statusTitle">Current Signal Status</div>
    <div class="traffic-light-box" id="trafficLightBox">
      <div class="traffic-device" id="device1">
        <div class="device-label blank-label" id="label1">&nbsp;</div>
        <div class="bulb blank" id="r1red"></div>
        <div class="bulb blank" id="r1yellow"></div>
        <div class="bulb blank" id="r1green"></div>
        <div class="timer-box timer-blank" id="timer1"><span class="clock-icon">🕑</span><span>--:--</span></div>
      </div>
      <div class="traffic-device" id="device2">
        <div class="device-label blank-label" id="label2">&nbsp;</div>
        <div class="bulb blank" id="r2red"></div>
        <div class="bulb blank" id="r2yellow"></div>
        <div class="bulb blank" id="r2green"></div>
        <div class="timer-box timer-blank" id="timer2"><span class="clock-icon">🕑</span><span>--:--</span></div>
      </div>
      <div class="traffic-device" id="device3">
        <div class="device-label blank-label" id="label3">&nbsp;</div>
        <div class="bulb blank" id="r3red"></div>
        <div class="bulb blank" id="r3yellow"></div>
        <div class="bulb blank" id="r3green"></div>
        <div class="timer-box timer-blank" id="timer3"><span class="clock-icon">🕑</span><span>--:--</span></div>
      </div>
      <div class="traffic-device" id="device4">
        <div class="device-label blank-label" id="label4">&nbsp;</div>
        <div class="bulb blank" id="r4red"></div>
        <div class="bulb blank" id="r4yellow"></div>
        <div class="bulb blank" id="r4green"></div>
        <div class="timer-box timer-blank" id="timer4"><span class="clock-icon">🕑</span><span>--:--</span></div>
      </div>
    </div>
  </div>
  <button class="nav-btn right" title="Next Page">&#8594;</button>
  <div class="actions-box">
    <button class="get-btn" type="button">Get Data</button>
    <button class="emergency-btn" type="button">
      <span class="emergency-symbol">&#9888;&#65039;</span>
      EMERGENCY
    </button>
  </div>
</div>
<script>
let GREEN_TIME = 10, RED_TIME = 10, YELLOW_TIME = 2;

// Route names for demo - update as needed
const routeNames = ["Janpath", "Cuttack Road", "Station Square", "KIIT Avenue"];

function setDeviceState(device, state, time, showActive) {
  const colors = ["red", "yellow", "green"];
  for (let c of colors) {
    let el = document.getElementById(`r${device}${c}`);
    let isOn = c === state && (state !== "yellow" || yellowState);
    if (showActive) {
      el.className = `bulb ${c}` + (isOn ? " on" : "");
    } else {
      el.className = "bulb blank";
    }
  }
  let timerEl = document.getElementById(`timer${device}`);
  if (!showActive) {
    timerEl.className = "timer-box timer-blank";
    timerEl.innerHTML = '<span class="clock-icon">🕑</span><span>--:--</span>';
  } else if (state === "red") {
    timerEl.className = "timer-box timer-red";
    timerEl.innerHTML = '<span class="clock-icon">🕑</span><span>00:'+ (time<10?'0':'')+time + '</span>';
  } else if (state === "yellow") {
    timerEl.className = "timer-box timer-yellow";
    timerEl.innerHTML = '<span class="clock-icon">🕑</span><span>00:02</span>';
  } else if (state === "green") {
    timerEl.className = "timer-box timer-green";
    timerEl.innerHTML = '<span class="clock-icon">🕑</span><span>00:'+ (time<10?'0':'')+time + '</span>';
  }
}

// Label states
function setDeviceLabel(id, text, name, showActive) {
  const el = document.getElementById('label'+id);
  if(showActive){
    el.className = 'device-label';
    el.innerHTML = `Sq. Route ${id}<br><span>${name}</span>`;
  } else {
    el.className = 'device-label blank-label';
    el.innerHTML = '&nbsp;';
  }
}

// Hide signals initially
let signalsActive = false;

let phase = 0;    // even: route1/3 green, odd: route2/4 green
let t = GREEN_TIME;
let yellowState = false;

function updateSignals() {
  if (!signalsActive) {
    for (let i = 1; i <= 4; i++) {
      setDeviceLabel(i, '', '', false);
      setDeviceState(i, "", 0, false);
    }
    return;
  }
  // Show labels
  for (let i = 1; i <= 4; i++)
    setDeviceLabel(i, '', routeNames[i-1], true);

  // Traffic logic with backward timer for red/green
  if (phase % 2 === 0) {
    // Route1/3 green, Route2/4 red
    setDeviceState(1, t > 0 ? "green" : (t > -YELLOW_TIME ? "yellow" : "red"), t > 0 ? t : 0, true);
    setDeviceState(3, t > 0 ? "green" : (t > -YELLOW_TIME ? "yellow" : "red"), t > 0 ? t : 0, true);

    // Red light: count downward (remaining seconds) while active
    setDeviceState(2, t > 0 ? "red" : (t > -YELLOW_TIME ? "yellow" : "green"),
      t > 0 ? RED_TIME - t + 1 : 0, true);
    setDeviceState(4, t > 0 ? "red" : (t > -YELLOW_TIME ? "yellow" : "green"),
      t > 0 ? RED_TIME - t + 1 : 0, true);
  } else {
    // Route2/4 green, Route1/3 red
    setDeviceState(2, t > 0 ? "green" : (t > -YELLOW_TIME ? "yellow" : "red"), t > 0 ? t : 0, true);
    setDeviceState(4, t > 0 ? "green" : (t > -YELLOW_TIME ? "yellow" : "red"), t > 0 ? t : 0, true);

    setDeviceState(1, t > 0 ? "red" : (t > -YELLOW_TIME ? "yellow" : "green"),
      t > 0 ? RED_TIME - t + 1 : 0, true);
    setDeviceState(3, t > 0 ? "red" : (t > -YELLOW_TIME ? "yellow" : "green"),
      t > 0 ? RED_TIME - t + 1 : 0, true);
  }
}

setInterval(()=>{
  if(signalsActive){
    // Handle yellow blinking only during yellow
    if (t <= 0 && t > -YELLOW_TIME) {
      yellowState = !yellowState;
    } else {
      yellowState = true;
    }
    updateSignals();
    t--;
    if (t < -YELLOW_TIME) {
      phase = (phase + 1) % 2;
      t = GREEN_TIME;
      yellowState = true;
    }
  } else {
    updateSignals(); // keep blanked
  }
}, 500);

// Timer change button
document.getElementById('changeTimerBtn').onclick = function() {
  let newTime = prompt("Enter new timer duration (in sec):", GREEN_TIME);
  if (newTime !== null) {
    let v = parseInt(newTime);
    if (!isNaN(v) && v > 0) {
      GREEN_TIME = v;
      RED_TIME = v;
      t = GREEN_TIME;
    } else {
      alert("Please enter a valid positive number.");
    }
  }
};

// "Apply" to start signals and reveal labels
document.getElementById('configForm').addEventListener('submit', function(e){
  e.preventDefault();
  signalsActive = true;
  // Show timer change after apply only
  document.getElementById('changeTimerBtn').style.display = '';
  updateSignals();
  // (inputs remain enabled, with current values visible/retained)
});
</script>
</body>
</html>